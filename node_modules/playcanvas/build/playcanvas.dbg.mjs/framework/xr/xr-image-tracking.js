/**
 * @license
 * PlayCanvas Engine v1.58.0 revision 6672f604c (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { platform } from '../../core/platform.js';
import { EventHandler } from '../../core/event-handler.js';
import { XrTrackedImage } from './xr-tracked-image.js';

class XrImageTracking extends EventHandler {

  constructor(manager) {
    super();
    this._manager = void 0;
    this._supported = platform.browser && !!window.XRImageTrackingResult;
    this._available = false;
    this._images = [];
    this._manager = manager;
    if (this._supported) {
      this._manager.on('start', this._onSessionStart, this);
      this._manager.on('end', this._onSessionEnd, this);
    }
  }

  add(image, width) {
    if (!this._supported || this._manager.active) return null;
    const trackedImage = new XrTrackedImage(image, width);
    this._images.push(trackedImage);
    return trackedImage;
  }

  remove(trackedImage) {
    if (this._manager.active) return;
    const ind = this._images.indexOf(trackedImage);
    if (ind !== -1) {
      trackedImage.destroy();
      this._images.splice(ind, 1);
    }
  }

  _onSessionStart() {
    this._manager.session.getTrackedImageScores().then(images => {
      this._available = true;
      for (let i = 0; i < images.length; i++) {
        this._images[i]._trackable = images[i] === 'trackable';
      }
    }).catch(err => {
      this._available = false;
      this.fire('error', err);
    });
  }

  _onSessionEnd() {
    this._available = false;
    for (let i = 0; i < this._images.length; i++) {
      const image = this._images[i];
      image._pose = null;
      image._measuredWidth = 0;
      if (image._tracking) {
        image._tracking = false;
        image.fire('untracked');
      }
    }
  }

  prepareImages(callback) {
    if (this._images.length) {
      Promise.all(this._images.map(function (trackedImage) {
        return trackedImage.prepare();
      })).then(function (bitmaps) {
        callback(null, bitmaps);
      }).catch(function (err) {
        callback(err, null);
      });
    } else {
      callback(null, null);
    }
  }

  update(frame) {
    if (!this._available) return;
    const results = frame.getImageTrackingResults();
    const index = {};
    for (let i = 0; i < results.length; i++) {
      index[results[i].index] = results[i];
      const trackedImage = this._images[results[i].index];
      trackedImage._emulated = results[i].trackingState === 'emulated';
      trackedImage._measuredWidth = results[i].measuredWidthInMeters;
      trackedImage._pose = frame.getPose(results[i].imageSpace, this._manager._referenceSpace);
    }
    for (let i = 0; i < this._images.length; i++) {
      if (this._images[i]._tracking && !index[i]) {
        this._images[i]._tracking = false;
        this._images[i].fire('untracked');
      } else if (!this._images[i]._tracking && index[i]) {
        this._images[i]._tracking = true;
        this._images[i].fire('tracked');
      }
    }
  }

  get supported() {
    return this._supported;
  }

  get available() {
    return this._available;
  }

  get images() {
    return this._images;
  }
}

export { XrImageTracking };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieHItaW1hZ2UtdHJhY2tpbmcuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsveHIveHItaW1hZ2UtdHJhY2tpbmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGxhdGZvcm0gfSBmcm9tICcuLi8uLi9jb3JlL3BsYXRmb3JtLmpzJztcbmltcG9ydCB7IEV2ZW50SGFuZGxlciB9IGZyb20gJy4uLy4uL2NvcmUvZXZlbnQtaGFuZGxlci5qcyc7XG5pbXBvcnQgeyBYclRyYWNrZWRJbWFnZSB9IGZyb20gJy4veHItdHJhY2tlZC1pbWFnZS5qcyc7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL3hyLW1hbmFnZXIuanMnKS5Yck1hbmFnZXJ9IFhyTWFuYWdlciAqL1xuXG4vKipcbiAqIEltYWdlIFRyYWNraW5nIHByb3ZpZGVzIHRoZSBhYmlsaXR5IHRvIHRyYWNrIHJlYWwgd29ybGQgaW1hZ2VzIGJ5IHByb3ZpZGVkIGltYWdlIHNhbXBsZXMgYW5kXG4gKiB0aGVpciBlc3RpbWF0ZWQgc2l6ZXMuXG4gKlxuICogQGF1Z21lbnRzIEV2ZW50SGFuZGxlclxuICovXG5jbGFzcyBYckltYWdlVHJhY2tpbmcgZXh0ZW5kcyBFdmVudEhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtYck1hbmFnZXJ9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfbWFuYWdlcjtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3N1cHBvcnRlZCA9IHBsYXRmb3JtLmJyb3dzZXIgJiYgISF3aW5kb3cuWFJJbWFnZVRyYWNraW5nUmVzdWx0O1xuXG4gICAgIC8qKlxuICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgICogQHByaXZhdGVcbiAgICAgICovXG4gICAgX2F2YWlsYWJsZSA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge1hyVHJhY2tlZEltYWdlW119XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaW1hZ2VzID0gW107XG5cbiAgICAvKipcbiAgICAgKiBJbWFnZSBUcmFja2luZyBwcm92aWRlcyB0aGUgYWJpbGl0eSB0byB0cmFjayByZWFsIHdvcmxkIGltYWdlcyBieSBwcm92aWRlZCBpbWFnZSBzYW1wbGVzIGFuZFxuICAgICAqIHRoZWlyIGVzdGltYXRlIHNpemVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtYck1hbmFnZXJ9IG1hbmFnZXIgLSBXZWJYUiBNYW5hZ2VyLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihtYW5hZ2VyKSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5fbWFuYWdlciA9IG1hbmFnZXI7XG5cbiAgICAgICAgaWYgKHRoaXMuX3N1cHBvcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5fbWFuYWdlci5vbignc3RhcnQnLCB0aGlzLl9vblNlc3Npb25TdGFydCwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9tYW5hZ2VyLm9uKCdlbmQnLCB0aGlzLl9vblNlc3Npb25FbmQsIHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlyZWQgd2hlbiB0aGUgWFIgc2Vzc2lvbiBpcyBzdGFydGVkLCBidXQgaW1hZ2UgdHJhY2tpbmcgZmFpbGVkIHRvIHByb2Nlc3MgdGhlIHByb3ZpZGVkXG4gICAgICogaW1hZ2VzLlxuICAgICAqXG4gICAgICogQGV2ZW50IFhySW1hZ2VUcmFja2luZyNlcnJvclxuICAgICAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIC0gRXJyb3Igb2JqZWN0IHJlbGF0ZWQgdG8gYSBmYWlsdXJlIG9mIGltYWdlIHRyYWNraW5nLlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQWRkIGFuIGltYWdlIGZvciBpbWFnZSB0cmFja2luZy4gQSB3aWR0aCBjYW4gYWxzbyBiZSBwcm92aWRlZCB0byBoZWxwIHRoZSB1bmRlcmx5aW5nIHN5c3RlbVxuICAgICAqIGVzdGltYXRlIHRoZSBhcHByb3ByaWF0ZSB0cmFuc2Zvcm1hdGlvbi4gTW9kaWZ5aW5nIHRoZSB0cmFja2VkIGltYWdlcyBsaXN0IGlzIG9ubHkgcG9zc2libGVcbiAgICAgKiBiZWZvcmUgYW4gQVIgc2Vzc2lvbiBpcyBzdGFydGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudHxIVE1MSW1hZ2VFbGVtZW50fFNWR0ltYWdlRWxlbWVudHxIVE1MVmlkZW9FbGVtZW50fEJsb2J8SW1hZ2VEYXRhfEltYWdlQml0bWFwfSBpbWFnZSAtIEltYWdlXG4gICAgICogdGhhdCBpcyBtYXRjaGluZyByZWFsIHdvcmxkIGltYWdlIGFzIGNsb3NlIGFzIHBvc3NpYmxlLiBSZXNvbHV0aW9uIG9mIGltYWdlcyBzaG91bGQgYmUgYXRcbiAgICAgKiBsZWFzdCAzMDB4MzAwLiBIaWdoIHJlc29sdXRpb24gZG9lcyBOT1QgaW1wcm92ZSB0cmFja2luZyBwZXJmb3JtYW5jZS4gQ29sb3Igb2YgaW1hZ2UgaXNcbiAgICAgKiBpcnJlbGV2YW50LCBzbyBncmF5c2NhbGUgaW1hZ2VzIGNhbiBiZSB1c2VkLiBJbWFnZXMgd2l0aCB0b28gbWFueSBnZW9tZXRyaWMgZmVhdHVyZXMgb3JcbiAgICAgKiByZXBlYXRpbmcgcGF0dGVybnMgd2lsbCByZWR1Y2UgdHJhY2tpbmcgc3RhYmlsaXR5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCAtIFdpZHRoIChpbiBtZXRlcnMpIG9mIGltYWdlIGluIHRoZSByZWFsIHdvcmxkLiBQcm92aWRpbmcgdGhpcyB2YWx1ZVxuICAgICAqIGFzIGNsb3NlIHRvIHRoZSByZWFsIHZhbHVlIHdpbGwgaW1wcm92ZSB0cmFja2luZyBxdWFsaXR5LlxuICAgICAqIEByZXR1cm5zIHtYclRyYWNrZWRJbWFnZXxudWxsfSBUcmFja2VkIGltYWdlIG9iamVjdCB0aGF0IHdpbGwgY29udGFpbiB0cmFja2luZyBpbmZvcm1hdGlvbi5cbiAgICAgKiBSZXR1cm5zIG51bGwgaWYgaW1hZ2UgdHJhY2tpbmcgaXMgbm90IHN1cHBvcnRlZCBvciBpZiB0aGUgWFIgbWFuYWdlciBpcyBub3QgYWN0aXZlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gaW1hZ2Ugd2l0aCB3aWR0aCBvZiAyMGNtICgwLjJtKVxuICAgICAqIGFwcC54ci5pbWFnZVRyYWNraW5nLmFkZChib29rQ292ZXJJbWcsIDAuMik7XG4gICAgICovXG4gICAgYWRkKGltYWdlLCB3aWR0aCkge1xuICAgICAgICBpZiAoIXRoaXMuX3N1cHBvcnRlZCB8fCB0aGlzLl9tYW5hZ2VyLmFjdGl2ZSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgdHJhY2tlZEltYWdlID0gbmV3IFhyVHJhY2tlZEltYWdlKGltYWdlLCB3aWR0aCk7XG4gICAgICAgIHRoaXMuX2ltYWdlcy5wdXNoKHRyYWNrZWRJbWFnZSk7XG4gICAgICAgIHJldHVybiB0cmFja2VkSW1hZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFuIGltYWdlIGZyb20gaW1hZ2UgdHJhY2tpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1hyVHJhY2tlZEltYWdlfSB0cmFja2VkSW1hZ2UgLSBUcmFja2VkIGltYWdlIHRvIGJlIHJlbW92ZWQuIE1vZGlmeWluZyB0aGUgdHJhY2tlZFxuICAgICAqIGltYWdlcyBsaXN0IGlzIG9ubHkgcG9zc2libGUgYmVmb3JlIGFuIEFSIHNlc3Npb24gaXMgc3RhcnRlZC5cbiAgICAgKi9cbiAgICByZW1vdmUodHJhY2tlZEltYWdlKSB7XG4gICAgICAgIGlmICh0aGlzLl9tYW5hZ2VyLmFjdGl2ZSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGluZCA9IHRoaXMuX2ltYWdlcy5pbmRleE9mKHRyYWNrZWRJbWFnZSk7XG4gICAgICAgIGlmIChpbmQgIT09IC0xKSB7XG4gICAgICAgICAgICB0cmFja2VkSW1hZ2UuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5faW1hZ2VzLnNwbGljZShpbmQsIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgX29uU2Vzc2lvblN0YXJ0KCkge1xuICAgICAgICB0aGlzLl9tYW5hZ2VyLnNlc3Npb24uZ2V0VHJhY2tlZEltYWdlU2NvcmVzKCkudGhlbigoaW1hZ2VzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9hdmFpbGFibGUgPSB0cnVlO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ltYWdlc1tpXS5fdHJhY2thYmxlID0gaW1hZ2VzW2ldID09PSAndHJhY2thYmxlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgdGhpcy5fYXZhaWxhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmZpcmUoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqIEBwcml2YXRlICovXG4gICAgX29uU2Vzc2lvbkVuZCgpIHtcbiAgICAgICAgdGhpcy5fYXZhaWxhYmxlID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9pbWFnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGltYWdlID0gdGhpcy5faW1hZ2VzW2ldO1xuICAgICAgICAgICAgaW1hZ2UuX3Bvc2UgPSBudWxsO1xuICAgICAgICAgICAgaW1hZ2UuX21lYXN1cmVkV2lkdGggPSAwO1xuXG4gICAgICAgICAgICBpZiAoaW1hZ2UuX3RyYWNraW5nKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2UuX3RyYWNraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaW1hZ2UuZmlyZSgndW50cmFja2VkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBhbGwgaW1hZ2VzIGhhdmUgYmVlbiBwcmVwYXJlZCBhcyBpbWFnZVxuICAgICAqIGJpdG1hcHMuXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIHByZXBhcmVJbWFnZXMoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuX2ltYWdlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIFByb21pc2UuYWxsKHRoaXMuX2ltYWdlcy5tYXAoZnVuY3Rpb24gKHRyYWNrZWRJbWFnZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cmFja2VkSW1hZ2UucHJlcGFyZSgpO1xuICAgICAgICAgICAgfSkpLnRoZW4oZnVuY3Rpb24gKGJpdG1hcHMpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCBiaXRtYXBzKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBudWxsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Kn0gZnJhbWUgLSBYUkZyYW1lIGZyb20gcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGNhbGxiYWNrLlxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICB1cGRhdGUoZnJhbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9hdmFpbGFibGUpIHJldHVybjtcblxuICAgICAgICBjb25zdCByZXN1bHRzID0gZnJhbWUuZ2V0SW1hZ2VUcmFja2luZ1Jlc3VsdHMoKTtcbiAgICAgICAgY29uc3QgaW5kZXggPSB7IH07XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpbmRleFtyZXN1bHRzW2ldLmluZGV4XSA9IHJlc3VsdHNbaV07XG5cbiAgICAgICAgICAgIGNvbnN0IHRyYWNrZWRJbWFnZSA9IHRoaXMuX2ltYWdlc1tyZXN1bHRzW2ldLmluZGV4XTtcbiAgICAgICAgICAgIHRyYWNrZWRJbWFnZS5fZW11bGF0ZWQgPSByZXN1bHRzW2ldLnRyYWNraW5nU3RhdGUgPT09ICdlbXVsYXRlZCc7XG4gICAgICAgICAgICB0cmFja2VkSW1hZ2UuX21lYXN1cmVkV2lkdGggPSByZXN1bHRzW2ldLm1lYXN1cmVkV2lkdGhJbk1ldGVycztcbiAgICAgICAgICAgIHRyYWNrZWRJbWFnZS5fcG9zZSA9IGZyYW1lLmdldFBvc2UocmVzdWx0c1tpXS5pbWFnZVNwYWNlLCB0aGlzLl9tYW5hZ2VyLl9yZWZlcmVuY2VTcGFjZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2ltYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2ltYWdlc1tpXS5fdHJhY2tpbmcgJiYgIWluZGV4W2ldKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW1hZ2VzW2ldLl90cmFja2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ltYWdlc1tpXS5maXJlKCd1bnRyYWNrZWQnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuX2ltYWdlc1tpXS5fdHJhY2tpbmcgJiYgaW5kZXhbaV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbWFnZXNbaV0uX3RyYWNraW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbWFnZXNbaV0uZmlyZSgndHJhY2tlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJ1ZSBpZiBJbWFnZSBUcmFja2luZyBpcyBzdXBwb3J0ZWQuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBnZXQgc3VwcG9ydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3VwcG9ydGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRydWUgaWYgSW1hZ2UgVHJhY2tpbmcgaXMgYXZhaWxhYmxlLiBUaGlzIHByb3BlcnR5IHdpbGwgYmUgZmFsc2UgaWYgbm8gaW1hZ2VzIHdlcmUgcHJvdmlkZWRcbiAgICAgKiBmb3IgdGhlIEFSIHNlc3Npb24gb3IgdGhlcmUgd2FzIGFuIGVycm9yIHByb2Nlc3NpbmcgdGhlIHByb3ZpZGVkIGltYWdlcy5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIGdldCBhdmFpbGFibGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hdmFpbGFibGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlzdCBvZiB7QGxpbmsgWHJUcmFja2VkSW1hZ2V9IHRoYXQgY29udGFpbiB0cmFja2luZyBpbmZvcm1hdGlvbi5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtYclRyYWNrZWRJbWFnZVtdfVxuICAgICAqL1xuICAgIGdldCBpbWFnZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbWFnZXM7XG4gICAgfVxufVxuXG5leHBvcnQgeyBYckltYWdlVHJhY2tpbmcgfTtcbiJdLCJuYW1lcyI6WyJYckltYWdlVHJhY2tpbmciLCJFdmVudEhhbmRsZXIiLCJjb25zdHJ1Y3RvciIsIm1hbmFnZXIiLCJfbWFuYWdlciIsIl9zdXBwb3J0ZWQiLCJwbGF0Zm9ybSIsImJyb3dzZXIiLCJ3aW5kb3ciLCJYUkltYWdlVHJhY2tpbmdSZXN1bHQiLCJfYXZhaWxhYmxlIiwiX2ltYWdlcyIsIm9uIiwiX29uU2Vzc2lvblN0YXJ0IiwiX29uU2Vzc2lvbkVuZCIsImFkZCIsImltYWdlIiwid2lkdGgiLCJhY3RpdmUiLCJ0cmFja2VkSW1hZ2UiLCJYclRyYWNrZWRJbWFnZSIsInB1c2giLCJyZW1vdmUiLCJpbmQiLCJpbmRleE9mIiwiZGVzdHJveSIsInNwbGljZSIsInNlc3Npb24iLCJnZXRUcmFja2VkSW1hZ2VTY29yZXMiLCJ0aGVuIiwiaW1hZ2VzIiwiaSIsImxlbmd0aCIsIl90cmFja2FibGUiLCJjYXRjaCIsImVyciIsImZpcmUiLCJfcG9zZSIsIl9tZWFzdXJlZFdpZHRoIiwiX3RyYWNraW5nIiwicHJlcGFyZUltYWdlcyIsImNhbGxiYWNrIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsInByZXBhcmUiLCJiaXRtYXBzIiwidXBkYXRlIiwiZnJhbWUiLCJyZXN1bHRzIiwiZ2V0SW1hZ2VUcmFja2luZ1Jlc3VsdHMiLCJpbmRleCIsIl9lbXVsYXRlZCIsInRyYWNraW5nU3RhdGUiLCJtZWFzdXJlZFdpZHRoSW5NZXRlcnMiLCJnZXRQb3NlIiwiaW1hZ2VTcGFjZSIsIl9yZWZlcmVuY2VTcGFjZSIsInN1cHBvcnRlZCIsImF2YWlsYWJsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBWUEsTUFBTUEsZUFBZSxTQUFTQyxZQUFZLENBQUM7O0VBZ0N2Q0MsV0FBVyxDQUFDQyxPQUFPLEVBQUU7QUFDakIsSUFBQSxLQUFLLEVBQUUsQ0FBQTtBQUFDLElBQUEsSUFBQSxDQTVCWkMsUUFBUSxHQUFBLEtBQUEsQ0FBQSxDQUFBO0lBQUEsSUFNUkMsQ0FBQUEsVUFBVSxHQUFHQyxRQUFRLENBQUNDLE9BQU8sSUFBSSxDQUFDLENBQUNDLE1BQU0sQ0FBQ0MscUJBQXFCLENBQUE7SUFBQSxJQU0vREMsQ0FBQUEsVUFBVSxHQUFHLEtBQUssQ0FBQTtJQUFBLElBTWxCQyxDQUFBQSxPQUFPLEdBQUcsRUFBRSxDQUFBO0lBWVIsSUFBSSxDQUFDUCxRQUFRLEdBQUdELE9BQU8sQ0FBQTtJQUV2QixJQUFJLElBQUksQ0FBQ0UsVUFBVSxFQUFFO0FBQ2pCLE1BQUEsSUFBSSxDQUFDRCxRQUFRLENBQUNRLEVBQUUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUE7QUFDckQsTUFBQSxJQUFJLENBQUNULFFB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
