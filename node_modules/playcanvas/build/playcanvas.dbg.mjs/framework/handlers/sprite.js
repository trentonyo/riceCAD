/**
 * @license
 * PlayCanvas Engine v1.58.0 revision 6672f604c (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { path } from '../../core/path.js';
import { http } from '../../platform/net/http.js';
import { Sprite } from '../../scene/sprite.js';

function onTextureAtlasLoaded(atlasAsset) {
  const spriteAsset = this;
  if (spriteAsset.resource) {
    spriteAsset.resource.atlas = atlasAsset.resource;
  }
}

function onTextureAtlasAdded(atlasAsset) {
  const spriteAsset = this;
  spriteAsset.registry.load(atlasAsset);
}

class SpriteHandler {

  constructor(app) {
    this.handlerType = "sprite";
    this._assets = app.assets;
    this._device = app.graphicsDevice;
    this.maxRetries = 0;
  }
  load(url, callback) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }

    if (path.getExtension(url.original) === '.json') {
      http.get(url.load, {
        retry: this.maxRetries > 0,
        maxRetries: this.maxRetries
      }, function (err, response) {
        if (!err) {
          callback(null, response);
        } else {
          callback(err);
        }
      });
    }
  }

  open(url, data) {
    const sprite = new Sprite(this._device);
    if (url) {
      sprite.__data = data;
    }
    return sprite;
  }

  patch(asset, assets) {
    const sprite = asset.resource;
    if (sprite.__data) {

      asset.data.pixelsPerUnit = sprite.__data.pixelsPerUnit;
      asset.data.renderMode = sprite.__data.renderMode;
      asset.data.frameKeys = sprite.__data.frameKeys;
      if (sprite.__data.textureAtlasAsset) {
        const atlas = assets.getByUrl(sprite.__data.textureAtlasAsset);
        if (atlas) {
          asset.data.textureAtlasAsset = atlas.id;
        } else {
          console.warn('Could not find textureatlas with url: ' + sprite.__data.textureAtlasAsset);
        }
      }

    }

    sprite.startUpdate();
    sprite.renderMode = asset.data.renderMode;
    sprite.pixelsPerUnit = asset.data.pixelsPerUnit;
    sprite.frameKeys = asset.data.frameKeys;
    this._updateAtlas(asset);
    sprite.endUpdate();
    asset.off('change', this._onAssetChange, this);
    asset.on('change', this._onAssetChange, this);
  }

  _updateAtlas(asset) {
    const sprite = asset.resource;
    if (!asset.data.textureAtlasAsset) {
      sprite.atlas = null;
      return;
    }
    this._assets.off('load:' + asset.data.textureAtlasAsset, onTextureAtlasLoaded, asset);
    this._assets.on('load:' + asset.data.textureAtlasAsset, onTextureAtlasLoaded, asset);
    const atlasAsset = this._assets.get(asset.data.textureAtlasAsset);
    if (atlasAsset && atlasAsset.resource) {
      sprite.atlas = atlasAsset.resource;
    } else {
      if (!atlasAsset) {
        this._assets.off('add:' + asset.data.textureAtlasAsset, onTextureAtlasAdded, asset);
        this._assets.on('add:' + asset.data.textureAtlasAsset, onTextureAtlasAdded, asset);
      } else {
        this._assets.load(atlasAsset);
      }
    }
  }
  _onAssetChange(asset, attribute, value, oldValue) {
    if (attribute === 'data') {
      if (value && value.textureAtlasAsset && oldValue && value.textureAtlasAsset !== oldValue.textureAtlasAsset) {
        this._assets.off('load:' + oldValue.textureAtlasAsset, onTextureAtlasLoaded, asset);
        this._assets.off('add:' + oldValue.textureAtlasAsset, onTextureAtlasAdded, asset);
      }
    }
  }
}

export { SpriteHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ByaXRlLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2hhbmRsZXJzL3Nwcml0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXRoIH0gZnJvbSAnLi4vLi4vY29yZS9wYXRoLmpzJztcblxuaW1wb3J0IHsgaHR0cCB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL25ldC9odHRwLmpzJztcblxuaW1wb3J0IHsgU3ByaXRlIH0gZnJvbSAnLi4vLi4vc2NlbmUvc3ByaXRlLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2ZyYW1ld29yay9hcHAtYmFzZS5qcycpLkFwcEJhc2V9IEFwcEJhc2UgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2hhbmRsZXIuanMnKS5SZXNvdXJjZUhhbmRsZXJ9IFJlc291cmNlSGFuZGxlciAqL1xuXG4vLyBUaGUgc2NvcGUgb2YgdGhpcyBmdW5jdGlvbiBpcyB0aGUgc3ByaXRlIGFzc2V0XG5mdW5jdGlvbiBvblRleHR1cmVBdGxhc0xvYWRlZChhdGxhc0Fzc2V0KSB7XG4gICAgY29uc3Qgc3ByaXRlQXNzZXQgPSB0aGlzO1xuICAgIGlmIChzcHJpdGVBc3NldC5yZXNvdXJjZSkge1xuICAgICAgICBzcHJpdGVBc3NldC5yZXNvdXJjZS5hdGxhcyA9IGF0bGFzQXNzZXQucmVzb3VyY2U7XG4gICAgfVxufVxuXG4vLyBUaGUgc2NvcGUgb2YgdGhpcyBmdW5jdGlvbiBpcyB0aGUgc3ByaXRlIGFzc2V0XG5mdW5jdGlvbiBvblRleHR1cmVBdGxhc0FkZGVkKGF0bGFzQXNzZXQpIHtcbiAgICBjb25zdCBzcHJpdGVBc3NldCA9IHRoaXM7XG4gICAgc3ByaXRlQXNzZXQucmVnaXN0cnkubG9hZChhdGxhc0Fzc2V0KTtcbn1cblxuLyoqXG4gKiBSZXNvdXJjZSBoYW5kbGVyIHVzZWQgZm9yIGxvYWRpbmcge0BsaW5rIFNwcml0ZX0gcmVzb3VyY2VzLlxuICpcbiAqIEBpbXBsZW1lbnRzIHtSZXNvdXJjZUhhbmRsZXJ9XG4gKi9cbmNsYXNzIFNwcml0ZUhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIFR5cGUgb2YgdGhlIHJlc291cmNlIHRoZSBoYW5kbGVyIGhhbmRsZXMuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGhhbmRsZXJUeXBlID0gXCJzcHJpdGVcIjtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBTcHJpdGVIYW5kbGVyIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcHBCYXNlfSBhcHAgLSBUaGUgcnVubmluZyB7QGxpbmsgQXBwQmFzZX0uXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICB0aGlzLl9hc3NldHMgPSBhcHAuYXNzZXRzO1xuICAgICAgICB0aGlzLl9kZXZpY2UgPSBhcHAuZ3JhcGhpY3NEZXZpY2U7XG4gICAgICAgIHRoaXMubWF4UmV0cmllcyA9IDA7XG4gICAgfVxuXG4gICAgbG9hZCh1cmwsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdXJsID0ge1xuICAgICAgICAgICAgICAgIGxvYWQ6IHVybCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogdXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgZ2l2ZW4gYSBqc29uIGZpbGUgKHByb2JhYmx5IGVuZ2luZS1vbmx5IHVzZSBjYXNlKVxuICAgICAgICBpZiAocGF0aC5nZXRFeHRlbnNpb24odXJsLm9yaWdpbmFsKSA9PT0gJy5qc29uJykge1xuICAgICAgICAgICAgaHR0cC5nZXQodXJsLmxvYWQsIHtcbiAgICAgICAgICAgICAgICByZXRyeTogdGhpcy5tYXhSZXRyaWVzID4gMCxcbiAgICAgICAgICAgICAgICBtYXhSZXRyaWVzOiB0aGlzLm1heFJldHJpZXNcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgc3ByaXRlIHJlc291cmNlXG4gICAgb3Blbih1cmwsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc3ByaXRlID0gbmV3IFNwcml0ZSh0aGlzLl9kZXZpY2UpO1xuICAgICAgICBpZiAodXJsKSB7XG4gICAgICAgICAgICAvLyBpZiB1cmwgZmllbGQgaXMgcHJlc2VudCBqc29uIGRhdGEgaXMgYmVpbmcgbG9hZGVkIGZyb20gZmlsZVxuICAgICAgICAgICAgLy8gc3RvcmUgZGF0YSBvbiBzcHJpdGUgb2JqZWN0IHRlbXBvcmFyaWx5XG4gICAgICAgICAgICBzcHJpdGUuX19kYXRhID0gZGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzcHJpdGU7XG4gICAgfVxuXG4gICAgLy8gU2V0IHNwcml0ZSBkYXRhXG4gICAgcGF0Y2goYXNzZXQsIGFzc2V0cykge1xuICAgICAgICBjb25zdCBzcHJpdGUgPSBhc3NldC5yZXNvdXJjZTtcbiAgICAgICAgaWYgKHNwcml0ZS5fX2RhdGEpIHtcbiAgICAgICAgICAgIC8vIGxvYWRpbmcgZnJvbSBhIGpzb24gZmlsZSB3ZSBoYXZlIGFzc2V0IGRhdGEgc3RvcmUgdGVtcG9yYXJpbHkgb24gdGhlIHNwcml0ZSByZXNvdXJjZVxuICAgICAgICAgICAgLy8gY29weSBpdCBpbnRvIGFzc2V0LmRhdGEgYW5kIGRlbGV0ZVxuXG4gICAgICAgICAgICBhc3NldC5kYXRhLnBpeGVsc1BlclVuaXQgPSBzcHJpdGUuX19kYXRhLnBpeGVsc1BlclVuaXQ7XG4gICAgICAgICAgICBhc3NldC5kYXRhLnJlbmRlck1vZGUgPSBzcHJpdGUuX19kYXRhLnJlbmRlck1vZGU7XG4gICAgICAgICAgICBhc3NldC5kYXRhLmZyYW1lS2V5cyA9IHNwcml0ZS5fX2RhdGEuZnJhbWVLZXlzO1xuXG4gICAgICAgICAgICBpZiAoc3ByaXRlLl9fZGF0YS50ZXh0dXJlQXRsYXNBc3NldCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0bGFzID0gYXNzZXRzLmdldEJ5VXJsKHNwcml0ZS5fX2RhdGEudGV4dHVyZUF0bGFzQXNzZXQpO1xuICAgICAgICAgICAgICAgIGlmIChhdGxhcykge1xuICAgICAgICAgICAgICAgICAgICBhc3NldC5kYXRhLnRleHR1cmVBdGxhc0Fzc2V0ID0gYXRsYXMuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb3VsZCBub3QgZmluZCB0ZXh0dXJlYXRsYXMgd2l0aCB1cmw6ICcgKyBzcHJpdGUuX19kYXRhLnRleHR1cmVBdGxhc0Fzc2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIG5vdGU6IHdlIGRvbid0IHJlbW92ZSBzcHJpdGUuX19kYXRhIGluIGNhc2UgYW5vdGhlciBhc3NldCBpcyBsb2FkZWQgZnJvbSB0aGUgc2FtZSBVUkwgd2hlbiBpdCBpcyBmZXRjaGVkIGZyb20gdGhlIGNhY2hlXG4gICAgICAgICAgICAvLyB0aGUgX19kYXRhIGlzIG5vdCByZS1hc3NpZ25lZCBhbmQgc28gYXNzZXQuZGF0YSBpcyBub3Qgc2V0IHVwLlxuICAgICAgICB9XG5cbiAgICAgICAgc3ByaXRlLnN0YXJ0VXBkYXRlKCk7XG4gICAgICAgIHNwcml0ZS5yZW5kZXJNb2RlID0gYXNzZXQuZGF0YS5yZW5kZXJNb2RlO1xuICAgICAgICBzcHJpdGUucGl4ZWxzUGVyVW5pdCA9IGFzc2V0LmRhdGEucGl4ZWxzUGVyVW5pdDtcbiAgICAgICAgc3ByaXRlLmZyYW1lS2V5cyA9IGFzc2V0LmRhdGEuZnJhbWVLZXlzO1xuICAgICAgICB0aGlzLl91cGRhdGVBdGxhcyhhc3NldCk7XG4gICAgICAgIHNwcml0ZS5lbmRVcGRhdGUoKTtcblxuICAgICAgICBhc3NldC5vZmYoJ2NoYW5nZScsIHRoaXMuX29uQXNzZXRDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBhc3NldC5vbignY2hhbmdlJywgdGhpcy5fb25Bc3NldENoYW5nZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgLy8gTG9hZCBhdGxhc1xuICAgIF91cGRhdGVBdGxhcyhhc3NldCkge1xuICAgICAgICBjb25zdCBzcHJpdGUgPSBhc3NldC5yZXNvdXJjZTtcbiAgICAgICAgaWYgKCFhc3NldC5kYXRhLnRleHR1cmVBdGxhc0Fzc2V0KSB7XG4gICAgICAgICAgICBzcHJpdGUuYXRsYXMgPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fYXNzZXRzLm9mZignbG9hZDonICsgYXNzZXQuZGF0YS50ZXh0dXJlQXRsYXNBc3NldCwgb25UZXh0dXJlQXRsYXNMb2FkZWQsIGFzc2V0KTtcbiAgICAgICAgdGhpcy5fYXNzZXRzLm9uKCdsb2FkOicgKyBhc3NldC5kYXRhLnRleHR1cmVBdGxhc0Fzc2V0LCBvblRleHR1cmVBdGxhc0xvYWRlZCwgYXNzZXQpO1xuXG4gICAgICAgIGNvbnN0IGF0bGFzQXNzZXQgPSB0aGlzLl9hc3NldHMuZ2V0KGFzc2V0LmRhdGEudGV4dHVyZUF0bGFzQXNzZXQpO1xuICAgICAgICBpZiAoYXRsYXNBc3NldCAmJiBhdGxhc0Fzc2V0LnJlc291cmNlKSB7XG4gICAgICAgICAgICBzcHJpdGUuYXRsYXMgPSBhdGxhc0Fzc2V0LnJlc291cmNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCFhdGxhc0Fzc2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXRzLm9mZignYWRkOicgKyBhc3NldC5kYXRhLnRleHR1cmVBdGxhc0Fzc2V0LCBvblRleHR1cmVBdGxhc0FkZGVkLCBhc3NldCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXRzLm9uKCdhZGQ6JyArIGFzc2V0LmRhdGEudGV4dHVyZUF0bGFzQXNzZXQsIG9uVGV4dHVyZUF0bGFzQWRkZWQsIGFzc2V0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXRzLmxvYWQoYXRsYXNBc3NldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25Bc3NldENoYW5nZShhc3NldCwgYXR0cmlidXRlLCB2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZSA9PT0gJ2RhdGEnKSB7XG4gICAgICAgICAgICAvLyBpZiB0aGUgdGV4dHVyZSBhdGxhcyBjaGFuZ2VkLCBjbGVhciBldmVudHMgZm9yIG9sZCBhdGxhcyBhc3NldFxuICAgICAgICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLnRleHR1cmVBdGxhc0Fzc2V0ICYmIG9sZFZhbHVlICYmIHZhbHVlLnRleHR1cmVBdGxhc0Fzc2V0ICE9PSBvbGRWYWx1ZS50ZXh0dXJlQXRsYXNBc3NldCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2V0cy5vZmYoJ2xvYWQ6JyArIG9sZFZhbHVlLnRleHR1cmVBdGxhc0Fzc2V0LCBvblRleHR1cmVBdGxhc0xvYWRlZCwgYXNzZXQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2V0cy5vZmYoJ2FkZDonICsgb2xkVmFsdWUudGV4dHVyZUF0bGFzQXNzZXQsIG9uVGV4dHVyZUF0bGFzQWRkZWQsIGFzc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgU3ByaXRlSGFuZGxlciB9O1xuIl0sIm5hbWVzIjpbIm9uVGV4dHVyZUF0bGFzTG9hZGVkIiwiYXRsYXNBc3NldCIsInNwcml0ZUFzc2V0IiwicmVzb3VyY2UiLCJhdGxhcyIsIm9uVGV4dHVyZUF0bGFzQWRkZWQiLCJyZWdpc3RyeSIsImxvYWQiLCJTcHJpdGVIYW5kbGVyIiwiY29uc3RydWN0b3IiLCJhcHAiLCJoYW5kbGVyVHlwZSIsIl9hc3NldHMiLCJhc3NldHMiLCJfZGV2aWNlIiwiZ3JhcGhpY3NEZXZpY2UiLCJtYXhSZXRyaWVzIiwidXJsIiwiY2FsbGJhY2siLCJvcmlnaW5hbCIsInBhdGgiLCJnZXRFeHRlbnNpb24iLCJodHRwIiwiZ2V0IiwicmV0cnkiLCJlcnIiLCJyZXNwb25zZSIsIm9wZW4iLCJkYXRhIiwic3ByaXRlIiwiU3ByaXRlIiwiX19kYXRhIiwicGF0Y2giLCJhc3NldCIsInBpeGVsc1BlclVuaXQiLCJyZW5kZXJNb2RlIiwiZnJhbWVLZXlzIiwidGV4dHVyZUF0bGFzQXNzZXQiLCJnZXRCeVVybCIsImlkIiwiY29uc29sZSIsIndhcm4iLCJzdGFydFVwZGF0ZSIsIl91cGRhdGVBdGxhcyIsImVuZFVwZGF0ZSIsIm9mZiIsIl9vbkFzc2V0Q2hhbmdlIiwib24iLCJhdHRyaWJ1dGUiLCJ2YWx1ZSIsIm9sZFZhbHVlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFVQSxTQUFTQSxvQkFBb0IsQ0FBQ0MsVUFBVSxFQUFFO0VBQ3RDLE1BQU1DLFdBQVcsR0FBRyxJQUFJLENBQUE7RUFDeEIsSUFBSUEsV0FBVyxDQUFDQyxRQUFRLEVBQUU7QUFDdEJELElBQUFBLFdBQVcsQ0FBQ0MsUUFBUSxDQUFDQyxLQUFLLEdBQUdILFVBQVUsQ0FBQ0UsUUFBUSxDQUFBO0FBQ3BELEdBQUE7QUFDSixDQUFBOztBQUdBLFNBQVNFLG1CQUFtQixDQUFDSixVQUFVLEVBQUU7RUFDckMsTUFBTUMsV0FBVyxHQUFHLElBQUksQ0FBQTtBQUN4QkEsRUFBQUEsV0FBVyxDQUFDSSxRQUFRLENBQUNDLElBQUksQ0FBQ04sVUFBVSxDQUFDLENBQUE7QUFDekMsQ0FBQTs7QUFPQSxNQUFNTyxhQUFhLENBQUM7O0VBY2hCQyxXQUFXLENB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
