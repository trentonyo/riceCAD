/**
 * @license
 * PlayCanvas Engine v1.58.0 revision 6672f604c (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
class DeviceCache {
  constructor() {
    this._cache = new Map();
  }
  get(device, onCreate) {
    if (!this._cache.has(device)) {
      this._cache.set(device, onCreate());

      device.on('destroy', () => {
        this.remove(device);
      });
    }
    return this._cache.get(device);
  }

  remove(device) {
    var _this$_cache$get;
    (_this$_cache$get = this._cache.get(device)) == null ? void 0 : _this$_cache$get.destroy();
    this._cache.delete(device);
  }
}

export { DeviceCache };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNlLWNhY2hlLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGxhdGZvcm0vZ3JhcGhpY3MvZGV2aWNlLWNhY2hlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2dyYXBoaWNzLWRldmljZS5qcycpLkdyYXBoaWNzRGV2aWNlfSBHcmFwaGljc0RldmljZSAqL1xuXG4vKipcbiAqIEEgY2FjaGUgc3RvcmluZyBzaGFyZWQgcmVzb3VyY2VzIGFzc29jaWF0ZWQgd2l0aCBhIGRldmljZS4gVGhlIHJlc291cmNlcyBhcmUgcmVtb3ZlZFxuICogZnJvbSB0aGUgY2FjaGUgd2hlbiB0aGUgZGV2aWNlIGlzIGRlc3Ryb3llZC5cbiAqXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIERldmljZUNhY2hlIHtcbiAgICAvKipcbiAgICAgKiBDYWNoZSBzdG9yaW5nIHRoZSByZXNvdXJjZSBmb3IgZWFjaCBHcmFwaGljc0RldmljZVxuICAgICAqXG4gICAgICogQHR5cGUge01hcDxHcmFwaGljc0RldmljZSwgYW55Pn1cbiAgICAgKi9cbiAgICBfY2FjaGUgPSBuZXcgTWFwKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXNvdXJjZXMgZm9yIHRoZSBzdXBwbGllZCBkZXZpY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0dyYXBoaWNzRGV2aWNlfSBkZXZpY2UgLSBUaGUgZ3JhcGhpY3MgZGV2aWNlLlxuICAgICAqIEByZXR1cm5zIHthbnl9IFRoZSByZXNvdXJjZSBmb3IgdGhlIGRldmljZS5cbiAgICAgKi9cbiAgICBnZXQoZGV2aWNlLCBvbkNyZWF0ZSkge1xuXG4gICAgICAgIGlmICghdGhpcy5fY2FjaGUuaGFzKGRldmljZSkpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLnNldChkZXZpY2UsIG9uQ3JlYXRlKCkpO1xuXG4gICAgICAgICAgICAvLyB3aGVuIHRoZSBkZXZpY2UgaXMgZGVzdHJveWVkLCBkZXN0cm95IGFuZCByZW1vdmUgaXRzIGVudHJ5XG4gICAgICAgICAgICBkZXZpY2Uub24oJ2Rlc3Ryb3knLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoZGV2aWNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlLmdldChkZXZpY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3llcyBhbmQgcmVtb3ZlcyB0aGUgY29udGVudCBvZiB0aGUgY2FjaGUgYXNzb2NpYXRlZCB3aXRoIHRoZSBkZXZpY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7R3JhcGhpY3NEZXZpY2V9IGRldmljZSAtIFRoZSBncmFwaGljcyBkZXZpY2UuXG4gICAgICovXG4gICAgcmVtb3ZlKGRldmljZSkge1xuICAgICAgICB0aGlzLl9jYWNoZS5nZXQoZGV2aWNlKT8uZGVzdHJveSgpO1xuICAgICAgICB0aGlzLl9jYWNoZS5kZWxldGUoZGV2aWNlKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IERldmljZUNhY2hlIH07XG4iXSwibmFtZXMiOlsiRGV2aWNlQ2FjaGUiLCJfY2FjaGUiLCJNYXAiLCJnZXQiLCJkZXZpY2UiLCJvbkNyZWF0ZSIsImhhcyIsInNldCIsIm9uIiwicmVtb3ZlIiwiZGVzdHJveSIsImRlbGV0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFRQSxNQUFNQSxXQUFXLENBQUM7QUFBQSxFQUFBLFdBQUEsR0FBQTtBQUFBLElBQUEsSUFBQSxDQU1kQyxNQUFNLEdBQUcsSUFBSUMsR0FBRyxFQUFFLENBQUE7QUFBQSxHQUFBO0FBUWxCQyxFQUFBQSxHQUFHLENBQUNDLE1BQU0sRUFBRUMsUUFBUSxFQUFFO0lBRWxCLElBQUksQ0FBQyxJQUFJLENBQUNKLE1BQU0sQ0FBQ0ssR0FBRyxDQUFDRixNQUFNLENBQUMsRUFBRTtNQUMxQixJQUFJLENBQUNILE1BQU0sQ0FBQ00sR0FBRyxDQUFDSCxNQUFNLEVBQUVDLFFBQVEsRUFBRSxDQUFDLENBQUE7O0FBR25DRCxNQUFBQSxNQUFNLENBQUNJLEVBQUUsQ0FBQyxTQUFTLEVBQUUsTUFBTTtBQUN2QixRQUFBLElBQUksQ0FBQ0MsTUFBTSxDQUFDTCxNQUFNLENBQUMsQ0FBQTtBQUN2QixPQUFDLENBQUMsQ0FBQTtBQUNOLEtBQUE7QUFFQSxJQUFBLE9BQU8sSUFBSSxDQUFDSCxNQUFNLENBQUNFLEdBQUcsQ0FBQ0MsTUFBTSxDQUFDLENBQUE7QUFDbEMsR0FBQTs7RUFPQUssTUFBTSxDQUFDTCxNQUFNLEVBQUU7QUFBQSxJQUFBLElBQUEsZ0JBQUEsQ0FBQTtJQUNYLENBQUksZ0JBQUEsR0FBQSxJQUFBLENBQUNILE1BQU0sQ0FBQ0UsR0FBRyxDQUFDQyxNQUFNLENBQUMsS0FBQSxJQUFBLEdBQUEsS0FBQSxDQUFBLEdBQXZCLGdCQUF5Qk0sQ0FBQUEsT0FBTyxFQUFFLENBQUE7QUFDbEMsSUFBQSxJQUFJLENBQUNULE1BQU0sQ0FBQ1UsTUFBTSxDQUFDUCxNQUFNLENBQUMsQ0FBQTtBQUM5QixHQUFBO0FBQ0o7Ozs7In0=
