/**
 * @license
 * PlayCanvas Engine v1.58.0 revision 6672f604c (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
class SortedLoopArray {
  constructor(args) {
    this.items = [];
    this.length = 0;
    this.loopIndex = -1;
    this._sortBy = args.sortBy;
    this._sortHandler = this._doSort.bind(this);
  }

  _binarySearch(item) {
    let left = 0;
    let right = this.items.length - 1;
    const search = item[this._sortBy];
    let middle;
    let current;
    while (left <= right) {
      middle = Math.floor((left + right) / 2);
      current = this.items[middle][this._sortBy];
      if (current <= search) {
        left = middle + 1;
      } else if (current > search) {
        right = middle - 1;
      }
    }
    return left;
  }
  _doSort(a, b) {
    const sortBy = this._sortBy;
    return a[sortBy] - b[sortBy];
  }

  insert(item) {
    const index = this._binarySearch(item);
    this.items.splice(index, 0, item);
    this.length++;
    if (this.loopIndex >= index) {
      this.loopIndex++;
    }
  }

  append(item) {
    this.items.push(item);
    this.length++;
  }

  remove(item) {
    const idx = this.items.indexOf(item);
    if (idx < 0) return;
    this.items.splice(idx, 1);
    this.length--;
    if (this.loopIndex >= idx) {
      this.loopIndex--;
    }
  }

  sort() {
    const current = this.loopIndex >= 0 ? this.items[this.loopIndex] : null;
    this.items.sort(this._sortHandler);
    if (current !== null) {
      this.loopIndex = this.items.indexOf(current);
    }
  }
}

export { SortedLoopArray };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29ydGVkLWxvb3AtYXJyYXkuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb3JlL3NvcnRlZC1sb29wLWFycmF5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSGVscGVyIGNsYXNzIHVzZWQgdG8gaG9sZCBhbiBhcnJheSBvZiBpdGVtcyBpbiBhIHNwZWNpZmljIG9yZGVyLiBUaGlzIGFycmF5IGlzIHNhZmUgdG8gbW9kaWZ5XG4gKiB3aGlsZSB3ZSBsb29wIHRocm91Z2ggaXQuIFRoZSBjbGFzcyBhc3N1bWVzIHRoYXQgaXQgaG9sZHMgb2JqZWN0cyB0aGF0IG5lZWQgdG8gYmUgc29ydGVkIGJhc2VkXG4gKiBvbiBvbmUgb2YgdGhlaXIgZmllbGRzLlxuICpcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgU29ydGVkTG9vcEFycmF5IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgU29ydGVkTG9vcEFycmF5IGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGFyZ3MgLSBBcmd1bWVudHMuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGFyZ3Muc29ydEJ5IC0gVGhlIG5hbWUgb2YgdGhlIGZpZWxkIHRoYXQgZWFjaCBlbGVtZW50IGluIHRoZSBhcnJheSBpcyBnb2luZ1xuICAgICAqIHRvIGJlIHNvcnRlZCBieS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBhcnJheSA9IG5ldyBwYy5Tb3J0ZWRMb29wQXJyYXkoeyBzb3J0Qnk6ICdwcmlvcml0eScgfSk7XG4gICAgICogYXJyYXkuaW5zZXJ0KGl0ZW0pOyAvLyBhZGRzIGl0ZW0gdG8gdGhlIHJpZ2h0IHNsb3QgYmFzZWQgb24gaXRlbS5wcmlvcml0eVxuICAgICAqIGFycmF5LmFwcGVuZChpdGVtKTsgLy8gYWRkcyBpdGVtIHRvIHRoZSBlbmQgb2YgdGhlIGFycmF5XG4gICAgICogYXJyYXkucmVtb3ZlKGl0ZW0pOyAvLyByZW1vdmVzIGl0ZW0gZnJvbSBhcnJheVxuICAgICAqIGZvciAoYXJyYXkubG9vcEluZGV4ID0gMDsgYXJyYXkubG9vcEluZGV4IDwgYXJyYXkubGVuZ3RoOyBhcnJheS5sb29wSW5kZXgrKykge1xuICAgICAqICAgLy8gZG8gdGhpbmdzIHdpdGggYXJyYXkgZWxlbWVudHNcbiAgICAgKiAgIC8vIHNhZmUgdG8gcmVtb3ZlIGFuZCBhZGQgZWxlbWVudHMgaW50byB0aGUgYXJyYXkgd2hpbGUgbG9vcGluZ1xuICAgICAqIH1cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcmdzKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaW50ZXJuYWwgYXJyYXkgdGhhdCBob2xkcyB0aGUgYWN0dWFsIGFycmF5IGVsZW1lbnRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7b2JqZWN0W119XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLml0ZW1zID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBhcnJheS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjdXJyZW50IGluZGV4IHVzZWQgdG8gbG9vcCB0aHJvdWdoIHRoZSBhcnJheS4gVGhpcyBnZXRzIG1vZGlmaWVkIGlmIHdlIGFkZCBvciByZW1vdmVcbiAgICAgICAgICogZWxlbWVudHMgZnJvbSB0aGUgYXJyYXkgd2hpbGUgbG9vcGluZy4gU2VlIHRoZSBleGFtcGxlIHRvIHNlZSBob3cgdG8gbG9vcCB0aHJvdWdoIHRoaXNcbiAgICAgICAgICogYXJyYXkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxvb3BJbmRleCA9IC0xO1xuXG4gICAgICAgIHRoaXMuX3NvcnRCeSA9IGFyZ3Muc29ydEJ5O1xuICAgICAgICB0aGlzLl9zb3J0SGFuZGxlciA9IHRoaXMuX2RvU29ydC5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNlYXJjaGVzIGZvciB0aGUgcmlnaHQgc3BvdCB0byBpbnNlcnQgdGhlIHNwZWNpZmllZCBpdGVtLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGl0ZW0gLSBUaGUgaXRlbS5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBUaGUgaW5kZXggd2hlcmUgdG8gaW5zZXJ0IHRoZSBpdGVtLlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2JpbmFyeVNlYXJjaChpdGVtKSB7XG4gICAgICAgIGxldCBsZWZ0ID0gMDtcbiAgICAgICAgbGV0IHJpZ2h0ID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICBjb25zdCBzZWFyY2ggPSBpdGVtW3RoaXMuX3NvcnRCeV07XG5cbiAgICAgICAgbGV0IG1pZGRsZTtcbiAgICAgICAgbGV0IGN1cnJlbnQ7XG4gICAgICAgIHdoaWxlIChsZWZ0IDw9IHJpZ2h0KSB7XG4gICAgICAgICAgICBtaWRkbGUgPSBNYXRoLmZsb29yKChsZWZ0ICsgcmlnaHQpIC8gMik7XG4gICAgICAgICAgICBjdXJyZW50ID0gdGhpcy5pdGVtc1ttaWRkbGVdW3RoaXMuX3NvcnRCeV07XG4gICAgICAgICAgICBpZiAoY3VycmVudCA8PSBzZWFyY2gpIHtcbiAgICAgICAgICAgICAgICBsZWZ0ID0gbWlkZGxlICsgMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudCA+IHNlYXJjaCkge1xuICAgICAgICAgICAgICAgIHJpZ2h0ID0gbWlkZGxlIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsZWZ0O1xuICAgIH1cblxuICAgIF9kb1NvcnQoYSwgYikge1xuICAgICAgICBjb25zdCBzb3J0QnkgPSB0aGlzLl9zb3J0Qnk7XG4gICAgICAgIHJldHVybiBhW3NvcnRCeV0gLSBiW3NvcnRCeV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0cyB0aGUgc3BlY2lmaWVkIGl0ZW0gaW50byB0aGUgYXJyYXkgYXQgdGhlIHJpZ2h0IGluZGV4IGJhc2VkIG9uIHRoZSAnc29ydEJ5JyBmaWVsZFxuICAgICAqIHBhc3NlZCBpbnRvIHRoZSBjb25zdHJ1Y3Rvci4gVGhpcyBhbHNvIGFkanVzdHMgdGhlIGxvb3BJbmRleCBhY2NvcmRpbmdseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBpdGVtIC0gVGhlIGl0ZW0gdG8gaW5zZXJ0LlxuICAgICAqL1xuICAgIGluc2VydChpdGVtKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fYmluYXJ5U2VhcmNoKGl0ZW0pO1xuICAgICAgICB0aGlzLml0ZW1zLnNwbGljZShpbmRleCwgMCwgaXRlbSk7XG4gICAgICAgIHRoaXMubGVuZ3RoKys7XG4gICAgICAgIGlmICh0aGlzLmxvb3BJbmRleCA+PSBpbmRleCkge1xuICAgICAgICAgICAgdGhpcy5sb29wSW5kZXgrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGVuZHMgdGhlIHNwZWNpZmllZCBpdGVtIHRvIHRoZSBlbmQgb2YgdGhlIGFycmF5LiBGYXN0ZXIgdGhhbiBpbnNlcnQoKSBhcyBpdCBkb2VzIG5vdFxuICAgICAqIGJpbmFyeSBzZWFyY2ggZm9yIHRoZSByaWdodCBpbmRleC4gVGhpcyBhbHNvIGFkanVzdHMgdGhlIGxvb3BJbmRleCBhY2NvcmRpbmdseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBpdGVtIC0gVGhlIGl0ZW0gdG8gYXBwZW5kLlxuICAgICAqL1xuICAgIGFwcGVuZChpdGVtKSB7XG4gICAgICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgdGhpcy5sZW5ndGgrKztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBzcGVjaWZpZWQgaXRlbSBmcm9tIHRoZSBhcnJheS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBpdGVtIC0gVGhlIGl0ZW0gdG8gcmVtb3ZlLlxuICAgICAqL1xuICAgIHJlbW92ZShpdGVtKSB7XG4gICAgICAgIGNvbnN0IGlkeCA9IHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgaWYgKGlkeCA8IDApIHJldHVybjtcblxuICAgICAgICB0aGlzLml0ZW1zLnNwbGljZShpZHgsIDEpO1xuICAgICAgICB0aGlzLmxlbmd0aC0tO1xuICAgICAgICBpZiAodGhpcy5sb29wSW5kZXggPj0gaWR4KSB7XG4gICAgICAgICAgICB0aGlzLmxvb3BJbmRleC0tO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU29ydHMgZWxlbWVudHMgaW4gdGhlIGFycmF5IGJhc2VkIG9uIHRoZSAnc29ydEJ5JyBmaWVsZCBwYXNzZWQgaW50byB0aGUgY29uc3RydWN0b3IuIFRoaXNcbiAgICAgKiBhbHNvIHVwZGF0ZXMgdGhlIGxvb3BJbmRleCBpZiB3ZSBhcmUgY3VycmVudGx5IGxvb3BpbmcuXG4gICAgICpcbiAgICAgKiBXQVJOSU5HOiBCZSBjYXJlZnVsIGlmIHlvdSBhcmUgc29ydGluZyB3aGlsZSBpdGVyYXRpbmcgYmVjYXVzZSBpZiBhZnRlciBzb3J0aW5nIHRoZSBhcnJheVxuICAgICAqIGVsZW1lbnQgdGhhdCB5b3UgYXJlIGN1cnJlbnRseSBwcm9jZXNzaW5nIGlzIG1vdmVkIGJlaGluZCBvdGhlciBlbGVtZW50cyB0aGVuIHlvdSBtaWdodCBlbmRcbiAgICAgKiB1cCBpdGVyYXRpbmcgb3ZlciBlbGVtZW50cyBtb3JlIHRoYW4gb25jZSFcbiAgICAgKi9cbiAgICBzb3J0KCkge1xuICAgICAgICAvLyBnZXQgY3VycmVudCBpdGVtIHBvaW50ZWQgdG8gYnkgbG9vcEluZGV4XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSAodGhpcy5sb29wSW5kZXggPj0gMCA/IHRoaXMuaXRlbXNbdGhpcy5sb29wSW5kZXhdIDogbnVsbCk7XG4gICAgICAgIC8vIHNvcnRcbiAgICAgICAgdGhpcy5pdGVtcy5zb3J0KHRoaXMuX3NvcnRIYW5kbGVyKTtcbiAgICAgICAgLy8gZmluZCBuZXcgbG9vcEluZGV4XG4gICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmxvb3BJbmRleCA9IHRoaXMuaXRlbXMuaW5kZXhPZihjdXJyZW50KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgU29ydGVkTG9vcEFycmF5IH07XG4iXSwibmFtZXMiOlsiU29ydGVkTG9vcEFycmF5IiwiY29uc3RydWN0b3IiLCJhcmdzIiwiaXRlbXMiLCJsZW5ndGgiLCJsb29wSW5kZXgiLCJfc29ydEJ5Iiwic29ydEJ5IiwiX3NvcnRIYW5kbGVyIiwiX2RvU29ydCIsImJpbmQiLCJfYmluYXJ5U2VhcmNoIiwiaXRlbSIsImxlZnQiLCJyaWdodCIsInNlYXJjaCIsIm1pZGRsZSIsImN1cnJlbnQiLCJNYXRoIiwiZmxvb3IiLCJhIiwiYiIsImluc2VydCIsImluZGV4Iiwic3BsaWNlIiwiYXBwZW5kIiwicHVzaCIsInJlbW92ZSIsImlkeCIsImluZGV4T2YiLCJzb3J0Il0sIm1hcHBpbmdzIjoiOzs7OztBQU9BLE1BQU1BLGVBQWUsQ0FBQztFQWlCbEJDLFdBQVcsQ0FBQ0MsSUFBSSxFQUFFO0lBTWQsSUFBSSxDQUFDQyxLQUFLLEdBQUcsRUFBRSxDQUFBO0lBTWYsSUFBSSxDQUFDQyxNQUFNLEdBQUcsQ0FBQyxDQUFBO0FBUWYsSUFBQSxJQUFJLENBQUNDLFNBQVMsR0FBRyxDQUFDLENBQUMsQ0FBQTtBQUVuQixJQUFBLElBQUksQ0FBQ0MsT0FBTyxHQUFHSixJQUFJLENBQUNLLE1BQU0sQ0FBQTtJQUMxQixJQUFJLENBQUNDLFlBQVksR0FBRyxJQUFJLENBQUNDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQy9DLEdBQUE7O0VBU0FDLGFBQWEsQ0FB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
