var e={};function r(r,t){var i;e[r]=!0,void 0!==t&&(i=t,window.console&&window.console.error&&window.console.error(i))}var t=function e(r){var t=r.gl;this.ext=r,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(r.maxVertexAttribs);for(var i=0;i<this.attribs.length;i++){var a=new e.VertexAttrib(t);this.attribs[i]=a}this.maxAttrib=0};(t.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=e.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var i=function(r){var t=this;this.gl=r,function(r){var t=r.getError;r.getError=function(){do{(i=t.apply(r))!=r.NO_ERROR&&(e[i]=!0)}while(i!=r.NO_ERROR);for(var i in e)if(e[i])return delete e[i],parseInt(i);return r.NO_ERROR}}(r);var i=this.original={getParameter:r.getParameter,enableVertexAttribArray:r.enableVertexAttribArray,disableVertexAttribArray:r.disableVertexAttribArray,bindBuffer:r.bindBuffer,getVertexAttrib:r.getVertexAttrib,vertexAttribPointer:r.vertexAttribPointer};r.getParameter=function(e){return e==t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject==t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},r.enableVertexAttribArray=function(e){var r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);var a=r.attribs[e];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},r.disableVertexAttribArray=function(e){var r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);var a=r.attribs[e];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},r.bindBuffer=function(e,a){switch(e){case r.ARRAY_BUFFER:t.currentArrayBuffer=a;break;case r.ELEMENT_ARRAY_BUFFER:t.currentVertexArrayObject.elementArrayBuffer=a}return i.bindBuffer.apply(this,arguments)},r.getVertexAttrib=function(e,a){var n=t.currentVertexArrayObject,s=n.attribs[e];switch(a){case r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return s.buffer;case r.VERTEX_ATTRIB_ARRAY_ENABLED:return s.enabled;case r.VERTEX_ATTRIB_ARRAY_SIZE:return s.size;case r.VERTEX_ATTRIB_ARRAY_STRIDE:return s.stride;case r.VERTEX_ATTRIB_ARRAY_TYPE:return s.type;case r.VERTEX_ATTRIB_ARRAY_NORMALIZED:return s.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},r.vertexAttribPointer=function(e,r,a,n,s,A){var c=t.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,e);var o=c.attribs[e];return o.buffer=t.currentArrayBuffer,o.size=r,o.type=a,o.normalized=n,o.stride=s,o.offset=A,o.recache(),i.vertexAttribPointer.apply(this,arguments)},r.instrumentExtension&&r.instrumentExtension(this,"OES_vertex_array_object"),r.canvas.addEventListener("webglcontextrestored",(function(){var e;e="OESVertexArrayObject emulation library context restored",window.console&&window.console.log&&window.console.log(e),t.reset_()}),!0),this.reset_()};i.prototype.VERTEX_ARRAY_BINDING_OES=34229,i.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;var r=this.gl;this.maxVertexAttribs=r.getParameter(r.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new t(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},i.prototype.createVertexArrayOES=function(){var e=new t(this);return this.vertexArrayObjects.push(e),e},i.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject==e&&this.bindVertexArrayOES(null)},i.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof t&&e.hasBeenBound&&e.ext==this)},i.prototype.bindVertexArrayOES=function(e){var t=this.gl;if(!e||e.isAlive){var i=this.original,a=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var n=this.currentVertexArrayObject;if(a!=n){a&&n.elementArrayBuffer==a.elementArrayBuffer||i.bindBuffer.call(t,t.ELEMENT_ARRAY_BUFFER,n.elementArrayBuffer);for(var s=this.currentArrayBuffer,A=Math.max(a?a.maxAttrib:0,n.maxAttrib),c=0;c<=A;c++){var o=n.attribs[c],b=a?a.attribs[c]:null;if(a&&o.enabled==b.enabled||(o.enabled?i.enableVertexAttribArray.call(t,c):i.disableVertexAttribArray.call(t,c)),o.enabled){var u=!1;a&&o.buffer==b.buffer||(s!=o.buffer&&(i.bindBuffer.call(t,t.ARRAY_BUFFER,o.buffer),s=o.buffer),u=!0),(u||o.cached!=b.cached)&&i.vertexAttribPointer.call(t,c,o.size,o.type,o.normalized,o.stride,o.offset)}}this.currentArrayBuffer!=s&&i.bindBuffer.call(t,t.ARRAY_BUFFER,this.currentArrayBuffer)}}else r(t.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject")};const a=function(e){if(e.getSupportedExtensions){if(-1!=e.getSupportedExtensions().indexOf("OES_vertex_array_object"))return}else if(e.getExtension){if(e.getExtension("OES_vertex_array_object"))return}if(e.getSupportedExtensions){var r=e.getSupportedExtensions;e.getSupportedExtensions=function(){var e=r.call(this)||[];return e.push("OES_vertex_array_object"),e}}var t=e.getExtension;e.getExtension=function(r){return"OES_vertex_array_object"==r?(e.__OESVertexArrayObject||(e.__OESVertexArrayObject=new i(e)),e.__OESVertexArrayObject):t?t.call(this,r):null}};export{a as setupVertexArrayObject};
