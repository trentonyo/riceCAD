import"../../core/tracing.js";import{Color as r}from"../../core/math/color.js";import{SHADERDEF_SKIN as o,SHADERDEF_SCREENSPACE as s,SHADERDEF_INSTANCING as t,SHADERDEF_MORPH_POSITION as e,SHADERDEF_MORPH_NORMAL as i,SHADERDEF_MORPH_TEXTURE_BASED as a}from"../constants.js";import{basic as h}from"../shader-lib/programs/basic.js";import{ShaderProcessorOptions as c}from"../../platform/graphics/shader-processor-options.js";import{getProgramLibrary as l}from"../shader-lib/get-program-library.js";import{Material as p}from"./material.js";class m extends p{constructor(){super(),this.color=new r(1,1,1,1),this.colorUniform=new Float32Array(4),this.colorMap=null,this.vertexColors=!1}copy(r){return super.copy(r),this.color.copy(r.color),this.colorMap=r.colorMap,this.vertexColors=r.vertexColors,this}updateUniforms(r,o){this.clearParameters(),this.colorUniform[0]=this.color.r,this.colorUniform[1]=this.color.g,this.colorUniform[2]=this.color.b,this.colorUniform[3]=this.color.a,this.setParameter("uColor",this.colorUniform),this.colorMap&&this.setParameter("texture_diffuseMap",this.colorMap)}getShaderVariant(r,p,m,n,f,u,d,g){if(this.updateShader)return this.updateShader(r,p,m,n,f,u),this.shader;const M={skin:m&&0!=(m&o),screenSpace:m&&0!=(m&s),useInstancing:m&&0!=(m&t),useMorphPosition:m&&0!=(m&e),useMorphNormal:m&&0!=(m&i),useMorphTextureBased:m&&0!=(m&a),alphaTest:this.alphaTest>0,vertexColors:this.vertexColors,diffuseMap:!!this.colorMap,pass:f},x=new c(d,g),b=l(r);return b.register("basic",h),b.getProgram("basic",M,x)}}export{m as BasicMaterial};
