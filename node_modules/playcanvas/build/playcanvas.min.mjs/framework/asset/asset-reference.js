class s{constructor(s,t,i,h,o){this.propertyName=s,this.parent=t,this._scope=o,this._registry=i,this.id=null,this.url=null,this.asset=null,this._onAssetLoad=h.load,this._onAssetAdd=h.add,this._onAssetRemove=h.remove,this._onAssetUnload=h.unload}set id(s){if(this.url)throw Error("Can't set id and url");this._unbind(),this._id=s,this.asset=this._registry.get(this._id),this._bind()}get id(){return this._id}set url(s){if(this.id)throw Error("Can't set id and url");this._unbind(),this._url=s,this.asset=this._registry.getByUrl(this._url),this._bind()}get url(){return this._url}_bind(){this.id&&(this._onAssetLoad&&this._registry.on("load:"+this.id,this._onLoad,this),this._onAssetAdd&&this._registry.once("add:"+this.id,this._onAdd,this),this._onAssetRemove&&this._registry.on("remove:"+this.id,this._onRemove,this),this._onAssetUnload&&this._registry.on("unload:"+this.id,this._onUnload,this)),this.url&&(this._onAssetLoad&&this._registry.on("load:url:"+this.url,this._onLoad,this),this._onAssetAdd&&this._registry.once("add:url:"+this.url,this._onAdd,this),this._onAssetRemove&&this._registry.on("remove:url:"+this.url,this._onRemove,this))}_unbind(){this.id&&(this._onAssetLoad&&this._registry.off("load:"+this.id,this._onLoad,this),this._onAssetAdd&&this._registry.off("add:"+this.id,this._onAdd,this),this._onAssetRemove&&this._registry.off("remove:"+this.id,this._onRemove,this),this._onAssetUnload&&this._registry.off("unload:"+this.id,this._onUnload,this)),this.url&&(this._onAssetLoad&&this._registry.off("load:"+this.url,this._onLoad,this),this._onAssetAdd&&this._registry.off("add:"+this.url,this._onAdd,this),this._onAssetRemove&&this._registry.off("remove:"+this.url,this._onRemove,this))}_onLoad(s){this._onAssetLoad.call(this._scope,this.propertyName,this.parent,s)}_onAdd(s){this.asset=s,this._onAssetAdd.call(this._scope,this.propertyName,this.parent,s)}_onRemove(s){this._onAssetRemove.call(this._scope,this.propertyName,this.parent,s),this.asset=null}_onUnload(s){this._onAssetUnload.call(this._scope,this.propertyName,this.parent,s)}}export{s as AssetReference};
