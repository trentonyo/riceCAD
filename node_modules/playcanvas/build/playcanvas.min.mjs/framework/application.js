import{platform as s}from"../core/platform.js";import{WebglGraphicsDevice as r}from"../platform/graphics/webgl/webgl-graphics-device.js";import{SoundManager as o}from"../platform/sound/manager.js";import{Lightmapper as m}from"./lightmapper/lightmapper.js";import{BatchManager as e}from"../scene/batching/batch-manager.js";import{AppBase as t}from"./app-base.js";import{AppOptions as p}from"./app-options.js";import{script as i}from"./script.js";import{AnimationComponentSystem as n}from"./components/animation/system.js";import{AnimComponentSystem as a}from"./components/anim/system.js";import{AudioListenerComponentSystem as c}from"./components/audio-listener/system.js";import{AudioSourceComponentSystem as f}from"./components/audio-source/system.js";import{ButtonComponentSystem as l}from"./components/button/system.js";import{CollisionComponentSystem as j}from"./components/collision/system.js";import{ElementComponentSystem as d}from"./components/element/system.js";import{JointComponentSystem as h}from"./components/joint/system.js";import{LayoutChildComponentSystem as y}from"./components/layout-child/system.js";import{LayoutGroupComponentSystem as g}from"./components/layout-group/system.js";import{ModelComponentSystem as u}from"./components/model/system.js";import{ParticleSystemComponentSystem as b}from"./components/particle-system/system.js";import{RenderComponentSystem as x}from"./components/render/system.js";import{RigidBodyComponentSystem as v}from"./components/rigid-body/system.js";import{ScreenComponentSystem as D}from"./components/screen/system.js";import{ScriptLegacyComponentSystem as O}from"./components/script-legacy/system.js";import{ScrollViewComponentSystem as w}from"./components/scroll-view/system.js";import{ScrollbarComponentSystem as P}from"./components/scrollbar/system.js";import{SoundComponentSystem as C}from"./components/sound/system.js";import{SpriteComponentSystem as H}from"./components/sprite/system.js";import{ZoneComponentSystem as S}from"./components/zone/system.js";import{CameraComponentSystem as k}from"./components/camera/system.js";import{LightComponentSystem as I}from"./components/light/system.js";import{ScriptComponentSystem as M}from"./components/script/system.js";import{RenderHandler as R}from"./handlers/render.js";import{AnimationHandler as z}from"./handlers/animation.js";import{AnimClipHandler as q}from"./handlers/anim-clip.js";import{AnimStateGraphHandler as A}from"./handlers/anim-state-graph.js";import{AudioHandler as B}from"./handlers/audio.js";import{BinaryHandler as E}from"./handlers/binary.js";import{ContainerHandler as F}from"./handlers/container.js";import{CssHandler as G}from"./handlers/css.js";import{CubemapHandler as J}from"./handlers/cubemap.js";import{FolderHandler as K}from"./handlers/folder.js";import{FontHandler as L}from"./handlers/font.js";import{HierarchyHandler as N}from"./handlers/hierarchy.js";import{HtmlHandler as Q}from"./handlers/html.js";import{JsonHandler as T}from"./handlers/json.js";import{MaterialHandler as U}from"./handlers/material.js";import{ModelHandler as V}from"./handlers/model.js";import{SceneHandler as W}from"./handlers/scene.js";import{ScriptHandler as X}from"./handlers/script.js";import{ShaderHandler as Y}from"./handlers/shader.js";import{SpriteHandler as Z}from"./handlers/sprite.js";import{TemplateHandler as $}from"./handlers/template.js";import{TextHandler as _}from"./handlers/text.js";import{TextureAtlasHandler as ss}from"./handlers/texture-atlas.js";import{TextureHandler as rs}from"./handlers/texture.js";import{XrManager as os}from"./xr/xr-manager.js";class ms extends t{constructor(s,r={}){super(s);const t=new p;t.graphicsDevice=this.createDevice(s,r),this.addComponentSystems(t),this.addResourceHandles(t),t.elementInput=r.elementInput,t.keyboard=r.keyboard,t.mouse=r.mouse,t.touch=r.touch,t.gamepads=r.gamepads,t.scriptPrefix=r.scriptPrefix,t.assetPrefix=r.assetPrefix,t.scriptsOrder=r.scriptsOrder,t.soundManager=new o,t.lightmapper=m,t.batchManager=e,t.xr=os,this.init(t)}createDevice(o,m){return m.graphicsDeviceOptions||(m.graphicsDeviceOptions={}),s.browser&&navigator.xr&&(m.graphicsDeviceOptions.xrCompatible=!0),m.graphicsDeviceOptions.alpha=m.graphicsDeviceOptions.alpha||!1,new r(o,m.graphicsDeviceOptions)}addComponentSystems(s){s.componentSystems=[v,j,h,n,a,u,x,k,I,i.legacy?O:M,f,C,c,b,D,d,l,w,P,H,g,y,S]}addResourceHandles(s){s.resourceHandlers=[R,z,q,A,V,U,rs,_,T,B,X,W,J,Q,G,Y,N,K,L,E,ss,Z,$,F]}}export{ms as Application};
